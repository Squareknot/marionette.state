function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}();!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("underscore"),require("backbone"),require("backbone.marionette")):"function"==typeof define&&define.amd?define(["underscore","backbone","backbone.marionette"],n):t.Marionette.State=n(t._,t.Backbone,t.Mn)}(this,function(t,n,e){"use strict";function i(e,i,s,o){var r,l=i instanceof n.Collection&&s.match(u),d=(i instanceof n.Model||i instanceof a)&&(r=s.match(h));if(l||d){var f=r&&i.get(r[1]);if(t.isFunction(o))o.call(e,i,f);else for(var v=o.split(c),y=0;y<v.length;y++){var g=v[y];e[g](i,f)}}}function s(t,n,e){for(var s in e)for(var o=e[s],r=s.split(c),a=0;a<r.length;a++){var h=r[a];i(t,n,h,o)}}function o(t,n,e,i){var s=new l(t,n,e);return i?s._when(i):s._now(),s}var r=e.Object.extend({modelClass:void 0,defaultState:void 0,componentEvents:void 0,_model:void 0,_component:void 0,_initialState:void 0,constructor:function(){var t=void 0===arguments[0]?{}:arguments[0],e=t.initialState,i=t.component,s=t.preventDestroy;this.modelClass=this.modelClass||n.Model,this._initState(e),i&&this.bindComponent(i,{preventDestroy:s}),r.__super__.constructor.apply(this,arguments)},_initState:function(n){this._initialState=t.extend({},this.defaultState,n),this._model?this.reset():(this._model=new this.modelClass(this._initialState),this._proxyModelEvents(this._model))},getModel:function(){return this._model},getInitialState:function(){return t.clone(this._initialState)},get:function(t){return this._model.get(t)},set:function(t,n,e){return this._model.set(t,n,e),this},reset:function(n,e){var i=t.extend({},this._initialState,n);return this._model.set(i,e),this},getChanged:function(){return this._model.changedAttributes()},getPrevious:function(){return this._model.previousAttributes()},hasAnyChanged:function(){for(var n=arguments.length,e=Array(n),i=0;n>i;i++)e[i]=arguments[i];return!!t.chain(this._model.changed).keys().intersection(e).size().value()},bindComponent:function(t){var n=void 0===arguments[1]?{}:arguments[1],e=n.preventDestroy;this.bindEntityEvents(t,this.componentEvents),e||this._bindLifecycle(t)},unbindComponent:function(t){this.unbindEntityEvents(t,this.componentEvents),this._unbindLifecycle(t)},_bindLifecycle:function(t){return this._boundDestroy||(this._boundDestroy=this.destroy.bind(this)),this.listenTo(t,"destroy",this._boundDestroy),this},_unbindLifecycle:function(t){return this.stopListening(t,"destroy",this._boundDestroy),this},syncEntityEvents:function(t,n,e){return r.syncEntityEvents(this,t,n,e),this},stopSyncingEntityEvents:function(t,n,e){r.stopSyncingEntityEvents(this,t,n,e)},_proxyModelEvents:function(t){this.listenTo(t,"all",function(){arguments.length>1&&arguments[1]===this._model&&(arguments[1]=this),this.trigger.apply(this,arguments)})}}),a=r,h=/^(?:all|change|change:(.+))$/,u=/^(?:all|reset)$/,c=/\s+/,l=function(){function n(t,e,i){_classCallCheck(this,n),this.target=t,this.entity=e,this.bindings=i}return _createClass(n,[{key:"stop",value:function(){this.target.off(this.event,this.handler),this.event=this.handler=null}},{key:"_when",value:function(n){e.bindEntityEvents(this.target,this.entity,this.bindings),this.event=n,this.handler=t.bind(s,this,this.target,this.entity,this.bindings),this.target.on(this.event,this.handler).on("destroy",t.bind(this.stop,this))}},{key:"_now",value:function(){e.bindEntityEvents(this.target,this.entity,this.bindings),s(this.target,this.entity,this.bindings)}}]),n}();a.syncEntityEvents=o;var d=a;return d});
//# sourceMappingURL=marionette.state.min.js.map